## 详解原理

### 1. Servlet生命周期

- 服务器启动时（`web.xml`配置`load-on-startup=1`，默认为0）或者第一次请求`servlet`时，就会初始化一个`servlet`对象，即执行`init(ServletConfig conf)`方法
- 该`servlet`对象处理客户端请求时，在`service(ServletRequest req,ServletRespose resq)`方法中执行
- 最后关闭服务器时执行`destroy()`方法，才会销毁这个`servlet`对象

<img src="C:\Users\HUANGYUE\Documents\GitHub\JavaWeb\Servlet\picture\874710-20170216103737254-1072057229.png" style="zoom:80%;" />

### 2. 为什么创建的`servlet`是继承自`HttpServlet`，而不是直接实现`Servlet`接口？ 

#### `servlet`的生命周期中，可以看出，执行的是`service`方法，为什么我们就只需要写`doGet`和`doPost`方法呢？

- `HttpServlet` 继承自`GenericServlet`，`GenericServlet`接口的作用（通用）就是实现`Servlet`方法

    <img src="C:\Users\HUANGYUE\Documents\GitHub\JavaWeb\Servlet\picture\874710-20170216104143472-1013662984.png" style="zoom:80%;" />

- `GenericServlet`的继承结构，实现了`Servlet`接口和`ServletConfig`接口

    <img src="C:\Users\HUANGYUE\Documents\GitHub\JavaWeb\Servlet\picture\874710-20170216104540738-1388356015.png" style="zoom:80%;" />

- **`Servlet`接口内容**

    <img src="C:\Users\HUANGYUE\Documents\GitHub\JavaWeb\Servlet\picture\874710-20170216142610660-322166979.png" style="zoom:80%;" />

    - `getServletConfig()`方法获取`ServletConfig`对象，`ServletConfig`对象可以获取到Servlet的一些信息
    - `ServletName、ServletContext、InitParameter、InitParameterNames`，可以通过`ServletConfig`接口查看

- **`ServletConfig`接口内容**

    <img src="C:\Users\HUANGYUE\Documents\GitHub\JavaWeb\Servlet\picture\874710-20170216143011050-806963452.png" style="zoom:80%;" />

    - `ServletContext`对象时`Servlet`上下文对象，可以获取大部分所需信息，例如路径、方法等

- 由此，`Servlet`接口的作用：

    - 三个生命周期的运行方法
    - 获取`ServletConfig`，通过`ServletConfig`又可以获取`ServletContext`

- `GenericServlet`实现了Servlet接口，还实现了`ServletConfig`接口，由此可以直接获取ServletContext

- **`GenericServlet`类内容**

    <img src="C:\Users\HUANGYUE\Documents\GitHub\JavaWeb\Servlet\picture\874710-20170216152220082-1786372762.png" style="zoom:80%;" />

    - `init()` 方法

        - `init(ServletConfig config)`

            <img src="C:\Users\HUANGYUE\Documents\GitHub\JavaWeb\Servlet\picture\874710-20170216145829785-244456335.png" style="zoom:80%;" />

            只有`init(ServletConfig config)`中带有`ServletConfig`对象，为了方便能够在其他地方也能直接使用`ServletConfig`对象，而不仅仅局限在`init(ServletConfig config)`方法中，所以创建一个私有的成员变量`config`，在`init(ServletConfig config)`方法中就将其赋值给`config`，然后通过`getServletConfig()`方法就能够获取`ServletConfig`对象了，

        - init()

            <img src="C:\Users\HUANGYUE\Documents\GitHub\JavaWeb\Servlet\picture\1.png" style="zoom:80%;" />

            ​		为了防止当我们需要在`init()`方法中做一点别的事情，我们想到的方法就是继承`GenericServlet`并且重写了`init(ServletConfig config)`方法，这样依赖，就破坏了原本在`GenericServlet`类中`init(ServletConfig config)`写的代码了，也就是在`GenericServlet`类中的成员变量`config`会一直是`null`，无法得到赋值，因为被重写了，就不会在执行`GenericServlet`中`init(ServletConfig config)`方法中的代码。

            　　要想赋值，就必须在重写的`init(ServletConfig config)`方法中调用父类的`init(ServletConfig config)`方法，也就是`super.init(ServletConfig config)`，这样一来，就很不方便，怕有时候会忘了写这句代码，所以在`GenericServlet`类中增加一个`init()`方法，

            ​        以后需要在`init`方法中需要初始化别的数据，只需要重写`init()`这个方法，而不需要去覆盖`init(ServletConfig config)`这个方法，这样设计，就好很多，不用在管`init(ServletConfig config)`这个其中的内容了。也不用出现其他的问题。

    - 　`service(ServletRequest req, ServletResponse resp)`
    
        <img src="C:\Users\HUANGYUE\Documents\GitHub\JavaWeb\Servlet\picture\2.png" style="zoom:80%;" />
    
        一个抽象方法，说明在`GenericServlet`类中并没有实现该内容，那么我们想到的是，在它上面肯定还有一层，也就是还有一个子类继承它